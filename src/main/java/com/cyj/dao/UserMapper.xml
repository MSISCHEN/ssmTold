<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cyj.dao.UserMapper">
    <!--根据用户id得到用户信息-->
    <select id="findUserById" parameterType="int" resultType="User">
        SELECT * FROM USER WHERE id=#{id}
    </select>

    <!--注册用户信息-->
    <insert id="insertUser" parameterType="user">
        /*将插入数据的主键返回，返回user对象中，这个只实用于自增主键*/
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT LAST_INSERT_ID()
        </selectKey>
        INSERT INTO USER (name,email,phone,password) VALUES (#{name},#{email},#{phone},#{password})
    </insert>

    <!--查找邮箱是否已存在-->
    <select id="findEmail" parameterType="java.lang.String" resultType="user">
        SELECT * FROM USER WHERE email=#{email}
    </select>
    <!--查看手机号码是否已存在-->
    <select id="findPhone" parameterType="java.lang.String" resultType="user">
        SELECT * FROM USER WHERE phone=#{phone}
    </select>

    <!--登陆-->
    <select id="findUserLogin" parameterType="UserLogin" resultType="User">
        SELECT * FROM USER
        <where>
            <if test="email!=null and email!=''">

                AND user.email=#{email}
            </if>
            <if test="phone!=null and phone!=''">
                AND user.phone=#{phone}
            </if>
            <if test="loginPwd!=null and loginPwd!=''">
                AND user.password=#{loginPwd}
            </if>
        </where>
    </select>
</mapper>